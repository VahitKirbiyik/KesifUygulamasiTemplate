# 🔐 KesifApp Keystore Oluşturma Scripti\n\nparam(\n    [string]$KeystorePath = ".\keystore\kesifapp.keystore",\n    [string]$KeyAlias = "kesifapp_key",\n    [string]$KeyPassword,\n    [string]$StorePassword,\n    [int]$ValidityDays = 10000,\n    [switch]$Help\n)\n\n# Script bilgileri\n$ScriptVersion = "1.0.0"\n$LastUpdated = "30 Ağustos 2025"\n\n# Renk tanımları\n$Green = "Green"\n$Yellow = "Yellow"\n$Red = "Red"\n$Cyan = "Cyan"\n$White = "White"\n\nfunction Write-ColorOutput {\n    param(\n        [string]$Message,\n        [string]$Color = $White\n    )\n    Write-Host $Message -ForegroundColor $Color\n}\n\nfunction Show-Help {\n    Write-ColorOutput "`n🔐 KesifApp Keystore Generator v$ScriptVersion" $Cyan\n    Write-ColorOutput "Son güncelleme: $LastUpdated`n" $Yellow\n\n    Write-ColorOutput "KULLANIM:" $Green\n    Write-ColorOutput "  .\create-keystore.ps1 [parametreler]`n"\n\n    Write-ColorOutput "PARAMETRELER:" $Green\n    Write-ColorOutput "  -KeystorePath <path>     Keystore dosya yolu (varsayılan: .\keystore\kesifapp.keystore)"\n    Write-ColorOutput "  -KeyAlias <alias>        Anahtar takma adı (varsayılan: kesifapp_key)"\n    Write-ColorOutput "  -KeyPassword <pass>      Anahtar şifresi"\n    Write-ColorOutput "  -StorePassword <pass>    Keystore şifresi"\n    Write-ColorOutput "  -ValidityDays <days>     Geçerlilik süresi (varsayılan: 10000 gün)"\n    Write-ColorOutput "  -Help                    Bu yardım mesajını gösterir`n"\n\n    Write-ColorOutput "ÖRNEKLER:" $Green\n    Write-ColorOutput "  .\create-keystore.ps1"\n    Write-ColorOutput "  .\create-keystore.ps1 -KeyPassword 'MyKeyPass123' -StorePassword 'MyStorePass123'"\n    Write-ColorOutput "  .\create-keystore.ps1 -KeystorePath '.\myapp.keystore' -ValidityDays 3650`n"\n\n    Write-ColorOutput "GÜVENLİK NOTLARI:" $Yellow\n    Write-ColorOutput "  - Şifrelerinizi güvenli bir yerde saklayın"\n    Write-ColorOutput "  - Keystore dosyasını yedekleyin"\n    Write-ColorOutput "  - Şifreleri kod içinde saklamayın"\n    Write-ColorOutput "  - Düzenli olarak keystore'u yenileyin`n"\n}\n\nfunction Test-Prerequisites {\n    Write-ColorOutput "`n🔍 Gereksinim kontrolü yapılıyor..." $Cyan\n\n    # Java keytool kontrolü\n    try {\n        $keytoolVersion = keytool -version 2>&1\n        Write-ColorOutput "✅ Java Keytool: $keytoolVersion" $Green\n    }\n    catch {\n        Write-ColorOutput "❌ Java Keytool bulunamadı. Lütfen JDK yükleyin." $Red\n        return $false\n    }\n\n    Write-ColorOutput "🎉 Gereksinimler sağlandı!`n" $Green\n    return $true\n}\n\nfunction Create-KeystoreDirectory {\n    $keystoreDir = Split-Path $KeystorePath -Parent\n\n    if (-not (Test-Path $keystoreDir)) {\n        try {\n            New-Item -ItemType Directory -Path $keystoreDir -Force | Out-Null\n            Write-ColorOutput "📁 Keystore klasörü oluşturuldu: $keystoreDir" $Green\n        }\n        catch {\n            Write-ColorOutput "❌ Keystore klasörü oluşturulamadı: $($_.Exception.Message)" $Red\n            return $false\n        }\n    }\n\n    return $true\n}\n\nfunction Generate-Passwords {\n    if (-not $KeyPassword) {\n        $script:KeyPassword = -join ((65..90) + (97..122) + (48..57) | Get-Random -Count 16 | ForEach-Object {[char]$_})\n        Write-ColorOutput "🔑 Rastgele anahtar şifresi oluşturuldu" $Yellow\n    }\n\n    if (-not $StorePassword) {\n        $script:StorePassword = -join ((65..90) + (97..122) + (48..57) | Get-Random -Count 16 | ForEach-Object {[char]$_})\n        Write-ColorOutput "🔐 Rastgele keystore şifresi oluşturuldu" $Yellow\n    }\n}\n\nfunction Create-Keystore {\n    Write-ColorOutput "`n🔐 Keystore oluşturuluyor..." $Cyan\n\n    # Sertifika bilgileri\n    $dname = "CN=KesifApp, OU=Development, O=Vahit Kirbiyik, L=Istanbul, ST=Turkey, C=TR"\n\n    $keytoolArgs = @(\n        "-genkeypair",\n        "-v",\n        "-keystore", $KeystorePath,\n        "-alias", $KeyAlias,\n        "-keyalg", "RSA",\n        "-keysize", "2048",\n        "-validity", $ValidityDays,\n        "-storepass", $StorePassword,\n        "-keypass", $KeyPassword,\n        "-dname", $dname\n    )\n\n    try {\n        & keytool $keytoolArgs\n        Write-ColorOutput "✅ Keystore başarıyla oluşturuldu" $Green\n        return $true\n    }\n    catch {\n        Write-ColorOutput "❌ Keystore oluşturma başarısız: $($_.Exception.Message)" $Red\n        return $false\n    }\n}\n\nfunction Verify-Keystore {\n    Write-ColorOutput "`n🔍 Keystore doğrulanıyor..." $Cyan\n\n    try {\n        $listResult = & keytool -list -v -keystore $KeystorePath -storepass $StorePassword 2>&1\n\n        if ($listResult -match $KeyAlias) {\n            Write-ColorOutput "✅ Keystore doğrulandı - Anahtar bulundu: $KeyAlias" $Green\n            return $true\n        }\n        else {\n            Write-ColorOutput "❌ Keystore doğrulama başarısız - Anahtar bulunamadı" $Red\n            return $false\n        }\n    }\n    catch {\n        Write-ColorOutput "❌ Keystore doğrulama hatası: $($_.Exception.Message)" $Red\n        return $false\n    }\n}\n\nfunction Show-Summary {\n    Write-ColorOutput "`n🎊 KEYSTORE ÖZETİ" $Cyan\n    Write-ColorOutput "=" * 50 $Cyan\n\n    Write-ColorOutput "📁 Keystore Yolu: $KeystorePath" $Green\n    Write-ColorOutput "🔑 Anahtar Takma Adı: $KeyAlias" $Green\n    Write-ColorOutput "📅 Geçerlilik: $ValidityDays gün" $Green\n    Write-ColorOutput "🔐 Keystore Şifresi: $StorePassword" $Yellow\n    Write-ColorOutput "🔑 Anahtar Şifresi: $KeyPassword" $Yellow\n\n    Write-ColorOutput "`n⚠️  ÖNEMLİ GÜVENLİK UYARILARI:" $Red\n    Write-ColorOutput "  • Bu şifreleri güvenli bir yerde saklayın" $White\n    Write-ColorOutput "  • Keystore dosyasını yedekleyin" $White\n    Write-ColorOutput "  • Şifreleri paylaşmayın" $White\n    Write-ColorOutput "  • Düzenli olarak keystore'u kontrol edin" $White\n\n    Write-ColorOutput "`n🚀 SONRAKİ ADIMLAR:" $Yellow\n    Write-ColorOutput "1. Şifreleri güvenli bir yerde saklayın" $White\n    Write-ColorOutput "  Örnek: password-manager, güvenli notlar" $White\n    Write-ColorOutput "2. Keystore dosyasını yedekleyin" $White\n    Write-ColorOutput "  Örnek: USB drive, cloud storage (encrypted)" $White\n    Write-ColorOutput "3. Build scriptinde şifreleri kullanın" $White\n    Write-ColorOutput "  Örnek: .\build-aab.ps1 -KeystorePassword '$StorePassword'" $White\n\n    Write-ColorOutput "`n📞 DESTEK:" $Yellow\n    Write-ColorOutput "GitHub: https://github.com/VahitKirbiyik/KesifUygulamasiTemplate" $White\n    Write-ColorOutput "Issues: https://github.com/VahitKirbiyik/KesifUygulamasiTemplate/issues" $White\n}\n\nfunction Save-Passwords {\n    $passwordFile = Join-Path (Split-Path $KeystorePath -Parent) "keystore-passwords.txt"\n\n    try {\n        $passwordContent = @"\n# KesifApp Keystore Şifreleri\n# Oluşturulma Tarihi: $(Get-Date -Format "yyyy-MM-dd HH:mm:ss")\n# Geçerlilik Süresi: $ValidityDays gün\n\nKEYSTORE_PATH=$KeystorePath\nKEY_ALIAS=$KeyAlias\nSTORE_PASSWORD=$StorePassword\nKEY_PASSWORD=$KeyPassword\n\n# GÜVENLİK UYARISI:\n# Bu dosyayı güvenli bir yerde saklayın\n# Şifreleri kod içinde kullanmayın\n# Düzenli olarak şifreleri değiştirin\n"@\n\n        $passwordContent | Out-File -FilePath $passwordFile -Encoding UTF8\n        Write-ColorOutput "💾 Şifreler kaydedildi: $passwordFile" $Green\n        Write-ColorOutput "⚠️  Bu dosyayı güvenli bir yerde saklayın!" $Red\n    }\n    catch {\n        Write-ColorOutput "❌ Şifre dosyası kaydedilemedi: $($_.Exception.Message)" $Yellow\n    }\n}\n\n# Ana script mantığı\nfunction Main {\n    if ($Help) {\n        Show-Help\n        return\n    }\n\n    Write-ColorOutput "`n🚀 KesifApp Keystore Generator başlatılıyor..." $Cyan\n    Write-ColorOutput "Versiyon: $ScriptVersion | Tarih: $LastUpdated" $Yellow\n\n    # Gereksinim kontrolü\n    if (-not (Test-Prerequisites)) {\n        Write-ColorOutput "`n❌ Gereksinimler sağlanamadı. Script durduruluyor." $Red\n        exit 1\n    }\n\n    # Keystore klasörü oluştur\n    if (-not (Create-KeystoreDirectory)) {\n        exit 1\n    }\n\n    # Şifreleri oluştur\n    Generate-Passwords\n\n    # Keystore oluştur\n    if (-not (Create-Keystore)) {\n        exit 1\n    }\n\n    # Keystore doğrula\n    if (-not (Verify-Keystore)) {\n        exit 1\n    }\n\n    # Şifreleri kaydet\n    Save-Passwords\n\n    # Özet göster\n    Show-Summary\n\n    Write-ColorOutput "`n🎉 KesifApp keystore başarıyla oluşturuldu!" $Green\n    Write-ColorOutput "Artık uygulamalarınızı imzalayabilirsiniz! 🔐`n" $Green\n}\n\n# Script'i çalıştır\nMain\n