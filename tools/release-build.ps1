# release-build.ps1\n# TÃ¼m test, build, signing ve artefact iÅŸlemlerini otomatikleÅŸtirir\n\n# 1ï¸âƒ£ .resx anahtar kontrolÃ¼\nWrite-Host "ğŸ”¹ TÃ¼m .resx dosyalarÄ± ve anahtarlar kontrol ediliyor..."\ndotnet run --project Tools/ResxKeyChecker --verify-all >> pre-commit.log 2>&1\n\n\n# 2ï¸âƒ£ Ã–zellik testleri\nWrite-Host "ğŸ”¹ Uygulama Ã¶zellikleri test ediliyor..."\ndotnet test --filter "Category=FeatureTest" --logger trx --results-directory TestResults >> pre-commit.log 2>&1\n\n# 1ï¸âƒ£ Hook kontrolleri\nWrite-Host "ğŸ”¹ pre-commit, pre-push ve commit-msg kontrolleri..."\nif (Test-Path ".\pre-commit.ps1") { & ".\pre-commit.ps1" }\nif (Test-Path ".\pre-push.ps1") { & ".\pre-push.ps1" }\n\n# 2ï¸âƒ£ .resx ve anahtar doÄŸrulama\nWrite-Host "ğŸ”¹ 26 dil .resx kontrolleri..."\ndotnet run --project Tools/ResxKeyChecker --verify-all >> pre-commit.log 2>&1\n\n# 3ï¸âƒ£ Ã–zellik testleri\nWrite-Host "ğŸ”¹ TÃ¼m Ã¶zellik testleri Ã§alÄ±ÅŸtÄ±rÄ±lÄ±yor..."\ndotnet test --filter "Category=FeatureTest" --logger trx --results-directory TestResults >> pre-commit.log 2>&1\n\n# 4ï¸âƒ£ Otomatik sÃ¼rÃ¼m ve build\nWrite-Host "ğŸ”¹ SÃ¼rÃ¼m ve build numarasÄ± gÃ¼ncelleniyor..."\n$versionFile = "VERSION.txt"\n$version = Get-Content $versionFile\n$versionParts = $version -split "\."\n$versionParts[2] = [int]$versionParts[2] + 1\n$newVersion = ($versionParts -join ".")\nSet-Content $versionFile $newVersion\n\n# Android ve iOS versiyon gÃ¼ncelle\n(Get-Content "Android/Properties/AndroidManifest.xml") -replace 'android:versionCode="\d+"', "android:versionCode=\"$($versionParts[2])\"" | Set-Content "Android/Properties/AndroidManifest.xml"\n(Get-Content "Android/Properties/AndroidManifest.xml") -replace 'android:versionName=".*"', "android:versionName=\"$newVersion\"" | Set-Content "Android/Properties/AndroidManifest.xml"\n\n(Get-Content "iOS/Info.plist") -replace '<key>CFBundleShortVersionString</key>\s*<string>.*</string>', "<key>CFBundleShortVersionString</key><string>$newVersion</string>" | Set-Content "iOS/Info.plist"\n(Get-Content "iOS/Info.plist") -replace '<key>CFBundleVersion</key>\s*<string>.*</string>', "<key>CFBundleVersion</key><string>$($versionParts[2])</string>" | Set-Content "iOS/Info.plist"\n\n# 5ï¸âƒ£ Changelog Ã¼retimi\nWrite-Host "ğŸ”¹ Changelog oluÅŸturuluyor..."\ngit log --pretty=format:"- %s" $(git describe --tags --abbrev=0)..HEAD > CHANGELOG.md\n\n# 6ï¸âƒ£ Build iÅŸlemleri\nWrite-Host "ğŸ”¹ Android build..."\ndotnet publish -c Release -f net8.0-android -o out/Android >> pre-commit.log 2>&1\nWrite-Host "ğŸ”¹ iOS build..."\ndotnet publish -c Release -f net8.0-ios -o out/iOS >> pre-commit.log 2>&1\n\n# 7ï¸âƒ£ Signing ve artefact yÃ¶netimi\n$keystorePath = ".\Keys\release.keystore"\n$keystorePass = $env:KEYSTORE_PASS\n$keystoreAlias = $env:KEYSTORE_ALIAS\n& "jarsigner" -verbose -sigalg SHA1withRSA -digestalg SHA1 -keystore $keystorePath out/Android/*.apk $keystoreAlias\n\ncd ios\nfastlane match appstore\nfastlane ios beta\ncd ..\n\n# 8ï¸âƒ£ Log ve hata kontrolÃ¼\nif (Test-Path ".\pre-commit.log") {\n    $errors = Get-Content ".\pre-commit.log" | Select-String "error|fail"\n    if ($errors) {\n        Write-Host "âŒ Hata bulundu. Ä°ÅŸlem durduruldu."\n        exit 1\n    } else {\n        Write-Host "âœ… TÃ¼m test, build ve release iÅŸlemleri baÅŸarÄ±lÄ±."\n    }\n}\n\n# 9ï¸âƒ£ Git iÅŸlemleri\ngit add .\ngit commit -m "All features tested, version updated, changelog generated, builds ready, beta prepared"\nWrite-Host "âœ… Commit tamamlandÄ±. Push yapÄ±labilir."\n\n# 1ï¸âƒ£0ï¸âƒ£ GitHub Actions workflow entegrasyonu\n# .github/workflows/ci-cd.yml dosyasÄ± release-build.ps1â€™i Ã§alÄ±ÅŸtÄ±racak\n# git add .\n\n# PowerShell script to build the project, run tests, generate coverage report, and clean up directories\n\n# Step 1: Build the project\nWrite-Host "Building the project..."\ndotnet build "..\KesifUygulamasiTemplate.csproj" --configuration Release\n\n# Step 2: Run tests and generate coverage report\nWrite-Host "Running tests and generating coverage report..."\ndotnet test "..\KesifUygulamasiTemplate.csproj" --collect:"XPlat Code Coverage"\n\n# Step 3: Clean up unnecessary directories\n$directoriesToClean = @(\n    "..\bin",\n    "..\obj",\n    "..\.vs",\n    "..\TestResults"\n)\n\nforeach ($dir in $directoriesToClean) {\n    if (Test-Path $dir) {\n        Write-Host "Cleaning up $dir..."\n        Remove-Item -Recurse -Force $dir\n    }\n}\n\nWrite-Host "Build, test, and cleanup process completed."\n\n# âœ… Versiyon format doÄŸrulama\n$versionFile = "VERSION.txt"\n$version = Get-Content $versionFile\nif ($version -notmatch '^\d+\.\d+\.\d+$') {\n    Write-Host "âŒ VERSION.txt formatÄ± geÃ§ersiz. x.y.z ÅŸeklinde olmalÄ±."\n    exit 1\n}\n\n# ğŸ”„ Versiyon artÄ±rma\n$versionParts = $version -split "\."\n$versionParts[2] = [int]$versionParts[2] + 1\n$newVersion = ($versionParts -join ".")\nSet-Content $versionFile $newVersion\n$versionCode = $versionParts[2]\n\n# ğŸ“± AndroidManifest.xml gÃ¼ncelleme\n(Get-Content "Android/Properties/AndroidManifest.xml") -replace 'android:versionCode="\d+"', "android:versionCode=`"$versionCode`"" | Set-Content "Android/Properties/AndroidManifest.xml"\n(Get-Content "Android/Properties/AndroidManifest.xml") -replace 'android:versionName=".*"', "android:versionName=`"$newVersion`"" | Set-Content "Android/Properties/AndroidManifest.xml"\n\n# ğŸ iOS Info.plist gÃ¼ncelleme\n(Get-Content "iOS/Info.plist") -replace '<key>CFBundleShortVersionString</key>\s*<string>.*</string>', "<key>CFBundleShortVersionString</key><string>$newVersion</string>" | Set-Content "iOS/Info.plist"\n(Get-Content "iOS/Info.plist") -replace '<key>CFBundleVersion</key>\s*<string>.*</string>', "<key>CFBundleVersion</key><string>$versionCode</string>" | Set-Content "iOS/Info.plist"\n\n# ğŸ“ Changelog Ã¼retimi\ngit log --pretty=format:"- %s" $(git describe --tags --abbrev=0)..HEAD > CHANGELOG.md\n\n# ğŸ§ª Test sonuÃ§larÄ±nda hata kontrolÃ¼\ndotnet test --filter "Category=FeatureTest" --logger trx --results-directory TestResults >> pre-commit.log 2>&1\nif (Test-Path ".\TestResults") {\n    $testErrors = Get-ChildItem ".\TestResults" -Recurse | Select-String "Failed|Error"\n    if ($testErrors) {\n        Write-Host "âŒ Test sonuÃ§larÄ±nda hata bulundu. Build durduruldu."\n        exit 1\n    }\n}\n\n# ğŸ“¦ Artefact boyut kontrolÃ¼\n$apkPath = "out/Android/app-release.apk"\nif (Test-Path $apkPath) {\n    $apkSizeMB = (Get-Item $apkPath).Length / 1MB\n    if ($apkSizeMB -gt 100) {\n        Write-Host "âš ï¸ APK boyutu $([math]::Round($apkSizeMB,2)) MB. Limit aÅŸÄ±ldÄ±!"\n    }\n    jarsigner -verify $apkPath\n}\n\n# ğŸ§¹ Log temizliÄŸi\nif (Test-Path ".\pre-commit.log") {\n    $cleanLog = Get-Content ".\pre-commit.log" | Where-Object { $_ -notmatch "warning|deprecated" }\n    $cleanLog | Set-Content ".\pre-commit-clean.log"\n    Write-Host "ğŸ“„ Log temizlendi. pre-commit-clean.log dosyasÄ±na yazÄ±ldÄ±."\n}\n\n# ğŸ§¬ Git iÅŸlemleri ve CI/CD tetikleme\ngit add .\ngit commit -m "v$newVersion: YayÄ±n Ã¶ncesi tÃ¼m iÅŸlemler tamamlandÄ±"\ngit tag "v$newVersion"\ngit push origin main --tags\n\n# ğŸ‰ Kutlama mesajÄ±\nWrite-Host "âœ… v$newVersion sÃ¼rÃ¼mÃ¼ baÅŸarÄ±yla oluÅŸturuldu, testler geÃ§ti, CI/CD tetiklendi. Play Store yayÄ±nÄ±na hazÄ±rsÄ±n!"\n