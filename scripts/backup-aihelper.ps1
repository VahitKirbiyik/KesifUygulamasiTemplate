param()\n\n$root = (Get-Location).Path\n$timestamp = Get-Date -Format "yyyyMMdd-HHmmss"\n$backupDir = Join-Path $root "backup-aihelper-$timestamp"\nNew-Item -ItemType Directory -Path $backupDir -Force | Out-Null\n\nWrite-Host "Backup dir: $backupDir"\n\n# Move KesifUygulamasi.AIHelper folder if present\n$aihelper = Join-Path $root 'KesifUygulamasi.AIHelper'\nif (Test-Path $aihelper) {\n    Write-Host "Moving AIHelper folder..."\n    Move-Item -Path $aihelper -Destination $backupDir -Force\n    Write-Host "Moved: $aihelper -> $backupDir"\n} else {\n    Write-Host "No KesifUygulamasi.AIHelper folder found."\n}\n\n# Move Ollama/OllamaPanel related files from Views if present\n$views = Join-Path $root 'Views'\nif (Test-Path $views) {\n    $ollamaFiles = Get-ChildItem -Path $views -Recurse -File -Include '*Ollama*' -ErrorAction SilentlyContinue\n    foreach ($f in $ollamaFiles) {\n        $rel = $f.FullName.Substring($root.Length).TrimStart('\')\n        Write-Host "Moving: $rel"\n        Move-Item -Path $f.FullName -Destination $backupDir -Force\n    }\n} else {\n    Write-Host "Views folder not found."\n}\n\n# Also move any top-level files that reference AIHelper namespaces (simple heuristic)\n$aihelperMatches = Get-ChildItem -Path $root -Recurse -File -Include *.xaml,*.cs -ErrorAction SilentlyContinue | Where-Object {\n    Select-String -Path $_.FullName -Pattern 'KesifUygulamasi.AIHelper' -Quiet\n}\nforeach ($m in $aihelperMatches) {\n    Write-Host "Archiving file referencing AIHelper: $($m.FullName)"\n    Move-Item -Path $m.FullName -Destination $backupDir -Force\n}\n\n# Clean obj and bin folders to remove generated references from previous builds\nWrite-Host "Cleaning obj/bin folders..."\nGet-ChildItem -Path $root -Recurse -Directory -Force -ErrorAction SilentlyContinue | Where-Object { $_.Name -in @('obj','bin') } | ForEach-Object {\n    try {\n        Remove-Item -LiteralPath $_.FullName -Recurse -Force -ErrorAction Stop\n        Write-Host "Removed: $($_.FullName)"\n    } catch {\n        Write-Host "Failed to remove: $($_.FullName) - $($_.Exception.Message)"\n    }\n}\n\nWrite-Host "AIHelper backup and cleanup complete. Backup location: $backupDir"\n