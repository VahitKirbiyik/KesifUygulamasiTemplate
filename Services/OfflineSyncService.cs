using System;\nusing System.Threading;\nusing System.Threading.Tasks;\nusing KesifUygulamasiTemplate.Services;\n\nnamespace KesifUygulamasiTemplate.Services\n{\n    /// <summary>\n    /// Arka planda veri senkronizasyonu yapan servis\n    /// </summary>\n    public class OfflineSyncService\n    {\n        private readonly MoonCompassService _moonCompassService;\n        private readonly ConnectivityService _connectivityService;\n        private readonly PushNotificationService _pushService;\n        private Timer _timer;\n\n        public OfflineSyncService(MoonCompassService moonCompassService, ConnectivityService connectivityService, PushNotificationService pushService)\n        {\n            _moonCompassService = moonCompassService;\n            _connectivityService = connectivityService;\n            _pushService = pushService;\n        }\n\n        public void Start()\n        {\n            _timer = new Timer(async _ => await SyncAsync(), null, TimeSpan.Zero, TimeSpan.FromMinutes(30));\n        }\n\n        public void Stop()\n        {\n            _timer?.Dispose();\n        }\n\n        public async Task SyncAsync()\n        {\n            if (_connectivityService.IsConnected)\n            {\n                // Örnek: Dolunay kontrolü\n                var moonData = await _moonCompassService.GetMoonDataAsync(40.0, 30.0); // Örnek konum\n                if (moonData != null && Math.Abs(moonData.Phase - 1.0) < 0.05)\n                {\n                    await _pushService.SendLocalNotificationAsync("Dolunay!", "Bu gece dolunay var.", "/MoonCompassPage");\n                }\n                // Diğer önemli olaylar için benzer kontroller eklenebilir\n            }\n        }\n    }\n}\n